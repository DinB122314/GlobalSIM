<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>GlobalSim Admin Panel</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    h1 { color: #2c3e50; }
    .section { margin-top: 20px; padding: 10px; border: 1px solid #ddd; }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; }
    table, th, td { border: 1px solid #ccc; }
    th, td { padding: 8px; text-align: left; }
    th { background-color: #f8f8f8; }
  </style>
</head>
<body>

<h1>GlobalSim Admin Panel</h1>
<p id="status">Loading authentication...</p>

<div id="panel" style="display:none;">
  
  <div class="section">
    <h2>ðŸ“Š Balances</h2>
    <table id="balanceTable">
      <tr><th>Email</th><th>Balance</th></tr>
    </table>
  </div>

  <div class="section">
    <h2>ðŸ“¥ Payment Proofs</h2>
    <table id="proofTable">
      <tr><th>User</th><th>Image</th><th>Status</th></tr>
    </table>
  </div>

  <div class="section">
    <h2>ðŸ“„ Orders</h2>
    <table id="ordersTable">
      <tr><th>User</th><th>Order Details</th><th>Date</th></tr>
    </table>
  </div>

</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-firestore.js"></script>

<script>

  const firebaseConfig = {
  apiKey: "AIzaSyB9xPfQDbAJjPS_6H081FEjSyEQUE80IkY",
  authDomain: "globalsim-54868.firebaseapp.com",
  projectId: "globalsim-54868",
  storageBucket: "globalsim-54868.firebasestorage.app",
  messagingSenderId: "128597882511",
  appId: "1:128597882511:web:e192fa863f3d7976b5a2fa"
};

  const app = firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const db = firebase.firestore();

  const adminEmails = ["danieleziuche@gmail.com"]; // list of admins

  function loadData() {
    // Balances
    db.collection("users").get().then(snapshot => {
      const table = document.getElementById("balanceTable");
      snapshot.forEach(doc => {
        const data = doc.data();
        const row = `<tr><td>${data.email}</td><td>${data.balance || 0}</td></tr>`;
        table.innerHTML += row;
      });
    });

    // Payment Proofs
    db.collection("paymentProofs").get().then(snapshot => {
      const table = document.getElementById("proofTable");
      snapshot.forEach(doc => {
        const data = doc.data();
        const row = `<tr><td>${data.email}</td>
                     <td><img src="${data.image}" width="100"></td>
                     <td>${data.status || "Pending"}</td></tr>`;
        table.innerHTML += row;
      });
    });

    // Orders
    db.collection("orders").get().then(snapshot => {
      const table = document.getElementById("ordersTable");
      snapshot.forEach(doc => {
        const data = doc.data();
        const row = `<tr><td>${data.email}</td>
                     <td>${data.details}</td>
                     <td>${data.date}</td></tr>`;
        table.innerHTML += row;
      });
    });
  }

  auth.onAuthStateChanged(user => {
    if (user) {
      if (adminEmails.includes(user.email)) {
        document.getElementById("status").style.display = "none";
        document.getElementById("panel").style.display = "block";
        loadData();
      } else {
        document.getElementById("status").textContent = "Access Denied: Not an admin.";
        auth.signOut();
      }
    } else {
      auth.signInWithPopup(new firebase.auth.GoogleAuthProvider())
        .catch(error => {
          document.getElementById("status").textContent = "Login Failed: " + error.message;
        });
    }
  });
</script>

</body>
</html>
